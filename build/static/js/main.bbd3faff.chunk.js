(this.webpackJsonptravigraphjs=this.webpackJsonptravigraphjs||[]).push([[0],{100:function(e,t,r){},159:function(e,t,r){},167:function(e,t,r){"use strict";r.r(t);var n=r(2),a=r.n(n),o=r(83),c=r.n(o),i=(r(100),r(1)),u=r(4),l=r(3),s=r.n(l),d=r(6),p=r(22),f=r(172),m=r(84),b=r.n(m),h=r(85),g=r.n(h),v=r(86);function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(r,!0).forEach((function(t){Object(i.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(e){var t=e.onSubmit,r=void 0===t?function(){}:t,o=e.onCancel,c=void 0===o?function(){}:o,i=e.init,l=void 0===i?{}:i,s=Object(n.useState)(l),d=Object(u.a)(s,2),p=d[0],f=d[1],m=p.repo,b=void 0===m?"":m,h=p.start,g=void 0===h?"":h,v=p.end,O=void 0===v?"":v,E=p.com,w=void 0!==E&&E;return a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),r({repo:b,start:+g,end:+O,com:w})}},a.a.createElement("label",{htmlFor:"repo"},"Repository name"),a.a.createElement("input",{name:"repo",value:b,onChange:function(e){return f(y({},p,{repo:e.target.value}))}}),a.a.createElement("label",{htmlFor:"start"},"Start build"),a.a.createElement("input",{name:"start",value:g,onChange:function(e){return f(y({},p,{start:e.target.value}))}}),a.a.createElement("label",{htmlFor:"end"},"End build"),a.a.createElement("input",{name:"end",value:O,onChange:function(e){return f(y({},p,{end:e.target.value}))}}),a.a.createElement("label",{htmlFor:"com"},"Using travis-ci.com (instead of .org)?"),a.a.createElement("input",{name:"com",type:"checkbox",checked:w,onChange:function(e){return f(y({},p,{com:e.target.checked}))}}),a.a.createElement("button",{type:"submit"},"Submit"),a.a.createElement("button",{onClick:function(e){e.preventDefault(),c(e)}},"Cancel"),a.a.createElement("button",{onClick:function(e){e.preventDefault();var t={repo:"facebook/create-react-app",start:0,end:500,com:!1};f(t),r(t)}},"Example"))}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];arguments.length>1&&arguments[1];if(!e.length)return[];var t=e.concat();t.sort((function(e,t){return e.duration-t.duration}));var r=t[Math.floor(t.length/4)].duration,n=t[Math.ceil(.75*t.length)].duration,a=n-r,o=n+3*a,c=r-3*a;return t.filter((function(e){return e.duration<o&&e.duration>c}))}r(159);function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(r,!0).forEach((function(t){Object(i.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var x=100,P={$schema:"https://vega.github.io/schema/vega-lite/v4.json",width:1e3,height:400,mark:"point",data:{name:"values"},selection:{grid:{type:"interval",bind:"scales"}},encoding:{y:{field:"duration",type:"quantitative",axis:{title:"Duration (minutes)"}},x:{field:"finished_at",timeUnit:"yearmonthdatehoursminutes",type:"temporal",scale:{nice:"week"},axis:{title:"Date"}},color:{field:"state",type:"nominal",scale:{domain:["failed","errored","canceled","passed"],range:["#d62728","#ff7f0e","#5ab43c","#1f77b4"]}}}},D=new b.a({cache:new g.a({maxSize:1e3}),fill:function(){var e=Object(d.a)(s.a.mark((function e(t,r){var n,a,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,a=t.headers,e.next=3,Object(v.a)(n,{headers:a,signal:r});case 3:if((o=e.sent).ok){e.next=6;break}throw new Error("failed http status ".concat(o.status));case 6:return e.next=8,o.json();case 8:return c=e.sent,e.abrupt("return",w(c.builds.map((function(e){return{message:(e.commit||{}).message,branch:(e.branch||{}).name,duration:e.duration/60,number:e.number,finished_at:e.finished_at,state:e.state}}))));case 10:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()});function C(e){var t=e.counter,r=e.repo,n=e.start,a=e.end,o=e.com,c="https://api.travis-ci.".concat(o?"com":"org","/repo/").concat(encodeURIComponent(r),"/builds?limit=").concat(x),i=n+x*t,u="".concat(c,"&offset=").concat(i,"&sort_by=id");return i<=a?u:void 0}var S=function(){return{loading:null,error:null,downloaded:null,controller:new AbortController,counter:0,builds:[]}};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement((function(){var e=Object(n.useState)(S()),t=Object(u.a)(e,2),r=t[0],o=t[1],c=Object(p.d)({repo:p.c,start:p.b,end:p.b,com:p.a}),i=Object(u.a)(c,2),l=i[0],m=i[1],b=r.counter,h=r.controller,g=r.builds,v=r.loading,O=r.downloaded,y=r.error;return Object(n.useEffect)((function(e){var t=e||{},r=t.repo,n=t.start,a=t.end;r&&!r.includes("/")&&o(k({},S(),{error:"Repo should be in the form user/name"})),a<=n&&o(k({},S(),{error:"End should be greater than start"}))}),[l]),Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(s.a.mark((function e(t){var n,a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(v&&t&&t.repo)){e.next=13;break}if(o(k({},r,{loading:"Loading...build ".concat(b*x)})),!(n=C(k({},t,{counter:b})))){e.next=12;break}return a=new Headers({"Travis-API-Version":"3"}),e.next=8,D.get(n,{url:n,headers:a},h.signal);case 8:c=e.sent,o(k({},r,{counter:b+1,controller:new AbortController,builds:g.concat(c)})),e.next=13;break;case 12:g.length?o(k({},r,{loading:null,downloaded:g})):o(k({},S(),{error:"No builds loaded"}));case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),"AbortError"!==(i=e.t0).name&&"ERR_ABORTED"!==i.code&&"AbortError: aborted"!==i.message&&"Error: aborted"!==i.message&&(console.error(e.t0),o(k({},S(),{error:e.t0.message})));case 18:case"end":return e.stop()}var i}),e,null,[[0,15]])})))).apply(this,arguments)}!function(t){e.apply(this,arguments)}(l)}),[v,l,b,h]),a.a.createElement(a.a.Fragment,null,a.a.createElement("h1",null,"travigraph-js - Travis-CI duration graph"),a.a.createElement("p",null,"Enter a repo name, the start build, and end build to query for. Also specify whether this is on travis-ci.com instead of .org with the checkbox. NOTE: The repository name is case sensitive!"),a.a.createElement(E,{init:l,onSubmit:function(e){v&&h.abort(),m(e),o(k({},S(),{loading:"Loading..."}))},onCancel:function(){v&&h.abort(),o(k({},S()))}}),v&&a.a.createElement("p",null,v),y&&a.a.createElement("p",{style:{color:"red"}},y),O&&a.a.createElement(f.a,{data:{values:O},spec:P}),a.a.createElement("a",{href:"https://github.com/cmdcolin/travigraphjs/"},"travigraph@GitHub"))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},95:function(e,t,r){e.exports=r(167)}},[[95,1,2]]]);
//# sourceMappingURL=main.bbd3faff.chunk.js.map