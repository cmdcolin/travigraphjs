(this.webpackJsonptravigraphjs=this.webpackJsonptravigraphjs||[]).push([[0],{102:function(e,t,n){},168:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),o=n(85),i=n.n(o),c=(n(102),n(1)),s=n(4),u=n(3),l=n.n(u),b=n(5),p=n(19),d=n(173),m=n(86),f=n.n(m),h=n(87),v=n.n(h),g=n(88),O=n(28),j=function(e){var t=e.onSubmit,n=e.initialValues,a=Object(O.b)({onSubmit:t,initialValues:n}),o=a.form,i=a.handleSubmit,c=a.pristine,s=a.submitting,u=Object(O.a)("repo",o),l=Object(O.a)("token",o),b=Object(O.a)("com",o);return r.a.createElement("form",{onSubmit:i},r.a.createElement("div",null,r.a.createElement("label",null,"Repo name"),r.a.createElement("input",u.input)),r.a.createElement("div",null,r.a.createElement("label",null,"Authorization token (only needed for private)"),r.a.createElement("input",l.input)),r.a.createElement("div",null,r.a.createElement("label",null,"On travis-ci.com instead of travis-ci.org?"),r.a.createElement("input",Object.assign({type:"checkbox",id:b.input.name,checked:b.input.value},b.input))),r.a.createElement("button",{type:"submit",disabled:c||s},"Submit"))};function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e.length)return[];var t=e.concat();t.sort((function(e,t){return e.duration-t.duration}));var n=t[Math.floor(t.length/4)].duration,a=t[Math.ceil(.75*t.length)].duration,r=a-n,o=a+3*r,i=n-3*r;return t.filter((function(e){return e.duration<o&&e.duration>i&&!!e.finished_at}))}var w=n(61),y=n.n(w);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(n,!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=100,A={$schema:"https://vega.github.io/schema/vega-lite/v4.json",width:1e3,height:400,mark:"point",data:{name:"values"},selection:{grid:{type:"interval",bind:"scales"}},encoding:{y:{field:"duration",type:"quantitative",axis:{title:"Duration (minutes)"}},x:{field:"finished_at",timeUnit:"yearmonthdatehoursminutes",type:"temporal",scale:{nice:"week"},axis:{title:"Date"}},color:{field:"state",type:"nominal",scale:{domain:["failed","errored","canceled","passed"],range:["#d62728","#ff7f0e","#5ab43c","#1f77b4"]}}}},P=new f.a({cache:new v.a({maxSize:1e3}),fill:function(){var e=Object(b.a)(l.a.mark((function e(t,n){var a,r,o,i,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.url,r=t.headers,o=y.a.get(JSON.stringify(t))){e.next=14;break}return e.next=5,Object(g.a)(a,{headers:r,signal:n});case 5:if((i=e.sent).ok){e.next=8;break}throw new Error("failed http status ".concat(i.status));case 8:return e.next=10,i.json();case 10:return c=e.sent,s=E(c.builds.map((function(e){return{message:(e.commit||{}).message,branch:(e.branch||{}).name,duration:e.duration/60,number:e.number,finished_at:e.finished_at,state:e.state}}))),y.a.set(JSON.stringify(t),s),e.abrupt("return",s);case 14:return e.abrupt("return",o);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()});function D(e){var t=e.counter,n=e.com,a=e.repo,r=e.end,o="https://api.travis-ci.".concat(n?"com":"org","/repo/").concat(encodeURIComponent(a),"/builds?limit=").concat(S),i=S*t,c="".concat(o,"&offset=").concat(i,"&sort_by=id");return i<r?c:void 0}function C(e){var t=e.com,n=e.repo;return"https://api.travis-ci.".concat(t?"com":"org","/repo/").concat(encodeURIComponent(n),"/builds?limit=1&offset=-1")}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement((function(){var e=Object(a.useState)(new AbortController),t=Object(s.a)(e,2),n=t[0],o=t[1],i=Object(p.d)({repo:p.c,start:p.b,end:p.b,com:p.a,token:p.c}),c=Object(s.a)(i,2),u=c[0],m=c[1],f=function(e,t){var n=Object(a.useState)(0),r=Object(s.a)(n,2),o=r[0],i=r[1],c=Object(a.useState)(),u=Object(s.a)(c,2),p=u[0],d=u[1],m=Object(a.useState)("Enter a repo"),f=Object(s.a)(m,2),h=f[0],v=f[1],g=Object(a.useState)([]),O=Object(s.a)(g,2),j=O[0],E=O[1],w=Object(a.useState)(),y=Object(s.a)(w,2),k=y[0],A=y[1],R={"Travis-API-Version":"3"};t.token&&(R.Authorization="token "+t.token);var _=new Headers(R);return Object(a.useEffect)((function(){Object(b.a)(l.a.mark((function e(){var n,a,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==k){e.next=9;break}return n=C(t),e.next=4,fetch(n,{headers:_});case 4:return a=e.sent,e.next=7,a.json();case 7:(r=e.sent.builds)&&r.length&&(o=+r[0].number,A(o));case 9:case"end":return e.stop()}}),e)})))()})),Object(a.useEffect)((function(){Object(b.a)(l.a.mark((function n(){var a,r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,void 0===k){n.next=14;break}if(!t||!t.repo){n.next=14;break}if(v("Loading build ".concat(o*S,"/").concat(k)),!(a=D(x({},t,{counter:o,end:k})))){n.next=13;break}return n.next=8,P.get(JSON.stringify({url:a,headers:_}),{url:a,headers:_},e);case 8:r=n.sent,E(j.concat(r)),i(o+1),n.next=14;break;case 13:j.length?v(void 0):d("No builds loaded");case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(0),"AbortError"!==(c=n.t0).name&&"ERR_ABORTED"!==c.code&&"AbortError: aborted"!==c.message&&"Error: aborted"!==c.message&&(console.error(n.t0),d(n.t0.message));case 19:case"end":return n.stop()}var c}),n,null,[[0,16]])})))()}),[h,t,o,j,e,_,k]),[h,p,j]}(n.signal,u),h=Object(s.a)(f,3),v=h[0],g=h[1],O=h[2];return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"travigraph-js - Travis-CI duration graph"),r.a.createElement("p",null,"Enter a repo name and optionally an authorization token, used for private repos Also specify whether this is on travis-ci.com or travis-ci.org with the checkbox. NOTE: The repository name is case sensitive!"),r.a.createElement(j,{initialValues:u,onSubmit:function(e){v&&n.abort(),o(new AbortController),m(e)},onCancel:function(){v&&n.abort()}}),g?r.a.createElement("p",{style:{color:"red"}},g):v?r.a.createElement("p",null,v):r.a.createElement(d.a,{data:{values:O},spec:A}),r.a.createElement("a",{href:"https://github.com/cmdcolin/travigraphjs/"},"travigraph@GitHub"))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},97:function(e,t,n){e.exports=n(168)}},[[97,1,2]]]);
//# sourceMappingURL=main.fc2f1e4d.chunk.js.map